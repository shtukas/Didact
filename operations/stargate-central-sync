#!/usr/bin/ruby

# encoding: UTF-8

require_relative "../Libs/loader.rb"

puts "Data Propagation (LocalDatablobsBufferOut to StargateCentralDatablobRepository)"
StargateCentralDataBlobs::propagateDatablobsWithPrimaryDeletion(LocalDatablobsBufferOut::repositoryFolderpath(), "#{StargateCentralDataBlobs::pathToCentral()}/DatablobsDepth1")

puts "Send local events to stargate event inbox"
EventsLocalToCentralInbox::localEventsToCentralInbox()

puts "Move stargate central inbox events to central objects"
StargateCuration::inboxToObjects()

puts "Move stargate central objects to local Librarian"
Librarian::getObjectsFromCentral()

# We do the following to make sure we have a self contained datablob repository on local
if Machines::isLucille20() then
    puts "File system check"
    FileSystemCheck::fsck()
end